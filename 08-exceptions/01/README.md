# Задача 1. Поломанная игра

## Описание

Ознакомьтесь с проектом по [ссылке](https://repl.it/@netologycsharp/ExceptionsErrorsHomework). Ваша задача найти и исправить все ошибки, а так же избавиться от всех блоков `try/catch`.

При правильном исправлении всех ошибок проект должен корректно выполняться и вычислять победителя.

# RPG игра

По легенде некий разработчик решил создать простую RPG игру и решил начать с разработки персонажей. В игре присутствуют различные персонажи `Player` со следующими характеристиками:
- жизнь
- мана
- скорость
- атака
- ловкость
- удача

Также реализованы основные персонажи:

1. Воин
2. Маг
3. Лучник

и улучшенные:

1. Гном - улучшенный Воин
2. Демиург - улучшенный Маг
3. Арбалетчик - улучшенный Лучник

У каждого воина в руках есть оружие.

## Оружие

В игре присутствуют меч, лук и посох, а также их улучшенные версии: длинный меч, длинный лук и посох.

Реализован базовый класс *Weapon* со следующими полями:
1. *Name* - название
2. *Attack* - размер атаки
3. *Durability* - прочность
4. *Range* - дальность

Свойствами
1. *IsBroken()*, показывающее, сломано ли оружие. Является *false* при Durability более 0 и *true* при durability равным 0. 


И методами (действиями оружия):
1. Метод *TakeDamage(int damage)*, добавляющий повреждение от соперника. 
Всё повреждение уменьшает значение прочности оружия (поле *Durability*).
Значение Durability не должно падать ниже 0.
2. Метод *GetDamage()*, рассчитывающий урон от удара данным оружием.
Если прочность оружия (*Durability*) больше или равна 30% от изначального, необходимо выдать значение
свойства attack иначе ```Attack / 2```. При прочности менее 0, метод возвращает 0.

## Готовые оружия
В игре присутствуют базовые и улучшенные оружия

Таблица 1. Классы оружия.

| class      | Name       | Attack | Durability | Range |
|------------|------------|--------|------------|-------|
| Arm        | Рука       | 1      | Infinity   | 1     |
| Bow        | Лук        | 10     | 200        | 3     |
| Sword      | Меч        | 25     | 500        | 1     |
| Knife      | Нож        | 5      | 300        | 1     |
| Staff      | Посох      | 8      | 300        | 2     |

Таблица 2. Классы усиленного оружия. Прочерк («-») - свойство берётся из __наследуемого__ класса.

| class      | наследуется от | Name           | Attack | Range | Durability |
|------------|----------------|----------------|--------|-------|------------|
| LongBow    | Bow            | Длинный лук    | 15     | 4     | -          |
| Axe        | Sword          | Секира         | 27     | -     | 800        |
| StormStaff | Staff          | Посох Бури     | 10     | 3     | -          |

## Персонажи
Реализован базовый класс игрока *Player* со следующими полями и их начальными значениями:
1. Life = 100 - количество здоровья
2. Magic = 20 - количество маны
3. Speed = 1 - скорость
4. Attack = 10 - уровень атаки
5. Agility = 5 - ловкость
6. PersonLuck = 10 - удача
8. Description = 'Игрок' - тип игрока
9. Weapon = new Arm() - начальное оружие
10. Name - имя игрока
11. Position - положение игрока на оси координат

Свойствами:
1. Luck - рандомная удача игрока
2. isDodged - возможность уворота
3. IsAttackBlocked - возможность блокировки удара
4. IsDead - является ли игрок мёртвым или нет

И методами:
1. *Turn(Player[] players)* - каждый ход игрок совершает следующую последовательность действий (именно в таком порядке): 
    выбирает врага, если у бойца нету врага (*chooseEnemy*), двигается (*moveToEnemy*), наносит удар (*tryAttack*).
2. *TakeDamage(double damage)*, принимающий полученный урон. Урон полностью вычитается из здоровья
персонажа. Значение здоровья персонажа не может падать меньше 0.
3. *TakeAttack(int damage)*, который наносит удар другому игроку. 
Работа метода идёт в следующем порядке:
    1. Если атака была заблокирована (*IsAttackBlocked*), урон приходится по оружию (*weapon.TakeDamage*).
    2. Если произошло уклонение (*isDodged*), урон не засчитывается
    3. В иных случаях игрок получает урон, равный damage
4. *getDamage(int distance)*, рассчитывающий силу удара по формуле:
```(attack + weaponDamage) *  getLuck() / distance```. *distance* - расстояние между игроками, 
*weaponDamage* - значение урона текущего оружия у игрока ( *weapon.GetDamage()*).
При значении *distance*, превышающем свойство range оружия, метод возвращает 0.
5. *tryAttack(Player enemy)*, реализует атаку игроком.
    1. Рассчитать расстояние между игроком и врагом (*distance*).
    2. Если дальность оружия (*weapon.Range*) не достаёт (больше *distance*) до врага, атака не засчитывается
        и метод прекращает работу.
    3. В ином случае записывается износ оружию (*weapon.takeDamage*) на ```10 * getLuck()```
    4. Нанесите урон (*getDamage*) противнику (*enemy.TakeAttack*)
    5. Если игроки имеют одно и то же положение (*Position*), атакуемый отскакивает 
        на 1 деление вправо и принимает урон (*enemy.TakeAttack*) с удвоенной силой (```damage * 2```)
6. *checkWeapon*, реализует проверку поломанности оружия. В случае, если оружие износилось (*weapon.IsBroken*), 
игрок получает следущее классом ниже. Так, для класса *Warrior* это будет 
*Sword* -> *Knife* -> *Arm*. Детали смотрите в колонке «Основное оружие» соответствующего класса.
P.S. У всех есть нож и голые руки.
7. *moveLeft(int distance)* и *moveRight(int distance)* - методы передвижения. За один вызов игрок может сместиться
на расстояние *distance*, но не более значения свойства *speed*. *moveLeft* уменьшает значение *position*,
*moveRight* увеличивает.
8. *move(int distance)* - метод передвижения. Если distance меньше нуля, вызывается *moveLeft(distance)*, иначе
и *moveRight(distance)*.
9. *moveToEnemy(Player enemy)*, котрый осуществляет движение по направлению к врагу.
10. *chooseEnemy(Player[] players)*, где players - массив живых игроков на поле. Метод выбирает для игрока противника с минимальным здоровьем, того кто находится ближе всех.


## Готовые персонажи 
В игре присутствуют уже готовые персонажи бойцов и их улучшенные версии.

Таблица 3. Классы бойцов. Прочерк («-») - свойство берётся из базового класса.

| class      | life | magic | speed | attack | agility | luck | description | weapon     | Основное оружие       |
|------------|------|-------|-------|--------|---------|------|-------------|------------|-----------------------|
| Warrior    | 120  | -     | 2     | 10     | -       | -    | Воин        | new Sword  | Sword -> Knife -> Arm |
| Archer     | 80   | 35    | -     | 5      | 10      | -    | Лучник      | new Bow    | Bow -> Knife -> Arm   |
| Mage       | 70   | 100   | -     | 5      | 8       | -    | Маг         | new Staff  | Staff -> Knife -> Arm |


Таблица 4. Классы улучшенных бойцов. Прочерк («-») - свойство берётся из __наследуемого__ класса.

| class       | наследуется от | life | magic | speed | attack | agility | luck | description    | weapon         | Основное оружие            |
|-------------|----------------|------|-------|-------|--------|---------|------|----------------|----------------|----------------------------|
| Dwarf       | Warrior        | 130  | -     | -     | 15     | -       | 20   | Гном           | new Axe        | Axe -> Knife -> Arm        |
| Crossbowman | Archer         | 85   | -     | -     | 8      | 20      | 15   | Арбалетчик     | new LongBow    | LongBow -> Knife -> Arm    |
| Demiurge    | Mage           | 80   | 120   | -     | 6      | -       | 12   | Демиург        | new StormStaff | StormStaff -> Knife -> Arm |

## Особенности персонажей
1. *Archer.GetDamage(int distance)*: сила удара рассчитывается по формуле
     ```(Attack + Weapon.Attack) * Luck * distance / Weapon.Range```    
2. *Warrior.TakeDamage(double damage)*: при уровне здоровья менее 50%, *Luck* > 0.8 и достаточном уровне маны, урон вычитается из маны, а не из здоровья. При нулевом значении маны урон вычитается из здоровья.
3. *Mage.TakeDamage(double damage)*: При уровне маны более 50%, маг получает урон в 1.5 раза меньше базового и 
    уменьшает значение маны на 12.
4. *Dwarf.TakeDamage(double damage)*: Каждый шестой удар соперника наносит в 2 раза меньше урона.
5. *Demiurge.getDamage(int distance)*: При уровне маны > 0 и удачи > 0.6, наносимый урон увеличавется в 1.5 раза.

## Игровой процесс
Методы *Play(Player[] takenPlayers)*, который принимает массив игроков. И выполняется до тех пор, пока на поле не останется один игрок. Игра состоит из шагов, где каждый игрок сначала проверяется: живой ли он? Если он мертв, то он удаляется с поля и ход передаётся следующему игроку. Если игрок жив, то выполняется его ход.

### Подсказки

> Не читайте этот раздел сразу, попытайтесь сначала решить задачу самостоятельно :)

<details>

<summary>Подсказка 1</summary>

Не стесняйтесь запускать проект - если будут ошибки, то вам укажут, в каком файле и на какой строчке есть ошибка, так можно сразу перемещаться в нужное место :)

</details>
